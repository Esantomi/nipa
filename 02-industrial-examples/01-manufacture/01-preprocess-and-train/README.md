# 데이터 확인하고 머신러닝 모델 학습하기
이번 실습에서는 반도체 공정 센서 데이터를 살펴보고 인공지능 모델을 학습하는 과정을 수행해 보겠습니다.

### 개요
복잡한 현대 반도체 제조 공정은 일반적으로 센서 및 공정 측정 지점에서 수집된 신호 혹은 변수 모니터링을 통해 일관된 감시를 받습니다.

그러나 이러한 모든 신호가 특정 모니터링 시스템에서 똑같이 가치가 있는 것은 아닙니다. 측정된 신호에는 유용한 정보, 관련 없는 정보 및 노이즈의 조합이 포함됩니다.

이번 실습에서는 **제조 과정에서 나올 수 있는 공정 이상을 머신러닝을 사용하여 예측**해 볼 것입니다.

### 실습 데이터 구조
반도체를 제조하는 공정에서 590개의 센서가 시간 별로 기록한 데이터 샘플 1,567개가 아래와 같이 주어졌습니다.

![image](https://user-images.githubusercontent.com/61646760/145709934-9cf28228-3a9b-408d-9724-b2868b103c5b.png)

`Pass/Fail` 칼럼은 타임 스탬프 별로 간단한 통과 실패율을 나타내며 여기서 –1은 통과(정상)에 해당하고 1은 실패(이상)에 해당합니다.

즉, 이 데이터 테이블은 **592개의 칼럼**(590개의 센서, 1개의 테스트 통과 결과, 1개의 시간 데이터)과 **1,567개의 로우(행)** 로 구성되어 있는 것입니다.

위 데이터를 기반으로 머신러닝 학습을 수행하여, 불량 반도체가 제조될 수 있는 공정 이상 유무를 예측하여 봅시다.

### 지시 사항
1. 아래 코드를 사용하여 데이터를 읽고 처리하는 과정을 수행해 보세요.  
    - `ma.preprocess()`
2. 아래 코드를 사용하여 학습을 수행시켜 보세요.  
    - `ma.train(x_train_us, y_train_us)`
3. `실행` 버튼을 눌러 출력된 데이터를 확인하고 학습 진행 과정을 확인해 보세요.
4. `제출` 버튼을 눌러 데이터를 처리하고, 학습을 시키는 코드를 올바르게 작성하였는지 확인해 보세요.

## 답안
```
import machine as ma

def main():
    
    """
    지시사항 1번. 데이터를 읽고 처리하는 코드를 작성해 보세요.
    """
    x_train_us, x_test_us, y_train_us, y_test_us = ma.preprocess()
    
    
    """
    지시사항 2번. 학습을 수행시켜 보세요.
    """
    model = ma.train(x_train_us, y_train_us)
    
    
if __name__ == "__main__":
    main()
```

### 실행 결과
```
데이터 읽는 중...
읽어 온 데이터를 출력합니다.
                     Time        0        1  ...     588       589  Pass/Fail
0     2008-07-19 11:55:00  3030.93  2564.00  ...     NaN       NaN         -1
1     2008-07-19 12:32:00  3095.78  2465.14  ...  0.0060  208.2045         -1
2     2008-07-19 13:17:00  2932.61  2559.94  ...  0.0148   82.8602          1
3     2008-07-19 14:43:00  2988.72  2479.90  ...  0.0044   73.8432         -1
4     2008-07-19 15:22:00  3032.24  2502.87  ...  0.0044   73.8432         -1
5     2008-07-19 17:53:00  2946.25  2432.84  ...  0.0052   44.0077         -1
6     2008-07-19 19:44:00  3030.27  2430.12  ...  0.0052   44.0077         -1
7     2008-07-19 19:45:00  3058.88  2690.15  ...  0.0063   95.0310         -1
8     2008-07-19 20:24:00  2967.68  2600.47  ...  0.0045  111.6525         -1
9     2008-07-19 21:35:00  3016.11  2428.37  ...  0.0073   90.2294         -1
10    2008-07-19 21:57:00  2994.05  2548.21  ...  0.0071   57.8122          1
11    2008-07-19 22:52:00  2928.84  2479.40  ...  0.0081   75.5077          1
12    2008-07-20 03:35:00  2920.07  2507.40  ...  0.0034   52.2039         -1
13    2008-07-21 08:21:00  3051.44  2529.27  ...  0.0034   52.2039         -1
14    2008-07-21 11:53:00  2963.97  2629.48  ...  0.0084  142.9080          1
15    2008-07-22 00:03:00  2988.31  2546.26  ...  0.0045  100.2745         -1
16    2008-07-22 02:59:00  3028.02  2560.87  ...  0.0042   82.0989         -1
17    2008-07-22 08:41:00  3032.73  2517.79  ...  0.0042   82.0989         -1
18    2008-07-22 11:47:00  3040.34  2501.16  ...  0.0042   82.0989         -1
19    2008-07-22 14:00:00  2988.30  2519.05  ...  0.0032   47.1586         -1
20    2008-07-22 15:30:00  2987.32  2528.81  ...  0.0032   47.1586         -1
21    2008-07-23 05:15:00      NaN  2481.85  ...  0.0023   34.4153         -1
22    2008-07-23 19:22:00  3002.27  2497.45  ...  0.0075  114.5979         -1
23    2008-07-25 15:23:00  2884.74  2514.54  ...  0.0077  216.8869          1
24    2008-07-27 04:18:00  3010.41  2632.80  ...  0.0101  125.0600         -1
25    2008-07-27 09:37:00  2979.74  2446.56  ...  0.0101  125.0600         -1
26    2008-07-27 11:10:00  3067.35  2456.33  ...  0.0101  125.0600         -1
27    2008-07-27 15:46:00  2988.99  2607.63  ...  0.0116  216.9552         -1
28    2008-07-27 16:06:00  2972.78  2431.57  ...  0.0053  127.5067         -1
29    2008-07-27 16:49:00  2981.85  2529.11  ...  0.0062  146.8715         -1
...                   ...      ...      ...  ...     ...       ...        ...
1537  2008-10-15 18:16:00  3006.22  2525.20  ...  0.0037   48.7045         -1
1538  2008-10-15 19:15:00  3128.11  2367.16  ...  0.0038   47.3376         -1
1539  2008-10-15 19:24:00  2908.94  2560.99  ...  0.0038   47.3376         -1
1540  2008-10-15 21:44:00  2996.04  2555.92  ...  0.0046   67.6676         -1
1541  2008-10-15 22:45:00  3246.31  2499.79  ...  0.0019   23.5979         -1
1542  2008-10-15 22:54:00  2965.57  2487.91  ...  0.0087  121.9426         -1
1543  2008-10-15 23:00:00  3109.18  2447.97  ...  0.0055   50.8827         -1
1544  2008-10-15 23:45:00  3108.98  2537.73  ...  0.0039   72.9676         -1
1545  2008-10-16 02:16:00  3100.19  2490.60  ...  0.0070  402.6874         -1
1546  2008-10-16 02:16:00  3093.24  2488.18  ...  0.0047  105.7142         -1
1547  2008-10-16 02:17:00  3008.77  2542.36  ...  0.0022   36.2975         -1
1548  2008-10-16 02:22:00  3027.01  2464.98  ...  0.0071   88.5812         -1
1549  2008-10-16 02:55:00  3183.63  2498.00  ...  0.0071   88.5812         -1
1550  2008-10-16 03:56:00  3072.20  2406.47  ...  0.0022   27.5514         -1
1551  2008-10-16 04:02:00  2958.43  2489.06  ...  0.0044   30.7574         -1
1552  2008-10-16 04:02:00  2939.35  2521.98  ...  0.0074  247.6285         -1
1553  2008-10-16 04:04:00  3020.79  2500.19  ...  0.0077  134.3983         -1
1554  2008-10-16 04:47:00  3031.78  2528.55  ...  0.0098  117.0945         -1
1555  2008-10-16 04:50:00  2902.96  2515.03  ...  0.0051  184.8703         -1
1556  2008-10-16 04:54:00  3025.21  2503.30  ...  0.0016   46.1076         -1
1557  2008-10-16 05:08:00  3072.10  2534.87  ...  0.0023   26.7330         -1
1558  2008-10-16 05:13:00  3012.30  2466.84  ...  0.0054  176.6783         -1
1559  2008-10-16 05:44:00  3076.33  2456.13  ...  0.0057  117.4564         -1
1560  2008-10-16 05:58:00  2770.40  2549.42  ...  0.0042  127.3154         -1
1561  2008-10-16 15:02:00  2951.14  2326.59  ...  0.0051   46.4573         -1
1562  2008-10-16 15:13:00  2899.41  2464.36  ...  0.0047  203.1720         -1
1563  2008-10-16 20:49:00  3052.31  2522.55  ...  0.0047  203.1720         -1
1564  2008-10-17 05:26:00  2978.81  2379.78  ...  0.0025   43.5231         -1
1565  2008-10-17 06:01:00  2894.92  2532.01  ...  0.0075   93.4941         -1
1566  2008-10-17 06:07:00  2944.92  2450.76  ...  0.0045  137.7844         -1

[1567 rows x 592 columns]

학습용 데이터와 테스트용 데이터로 분리 합니다.
학습용 데이터 크기: (166, 590)
테스트용 데이터 크기: (42, 590)
학습을 수행합니다.

학습 진행률:   0%|          | 0.00/5.00k [00:00<?, ?it/s]
학습 진행률:   2%|▏         | 100/5.00k [00:00<00:04, 993it/s]
학습 진행률:   4%|▍         | 201/5.00k [00:00<00:04, 998it/s]
학습 진행률:   6%|▌         | 301/5.00k [00:00<00:04, 998it/s]
학습 진행률:   8%|▊         | 402/5.00k [00:00<00:04, 1.00kit/s]
학습 진행률:  10%|█         | 504/5.00k [00:00<00:04, 1.00kit/s]
학습 진행률:  12%|█▏        | 605/5.00k [00:00<00:04, 1.01kit/s]
학습 진행률:  14%|█▍        | 705/5.00k [00:00<00:04, 1.00kit/s]
학습 진행률:  16%|█▌        | 807/5.00k [00:00<00:04, 1.01kit/s]
학습 진행률:  18%|█▊        | 909/5.00k [00:00<00:04, 1.01kit/s]
학습 진행률:  20%|██        | 1.01k/5.00k [00:01<00:03, 1.01kit/s]
학습 진행률:  22%|██▏       | 1.11k/5.00k [00:01<00:03, 1.01kit/s]
학습 진행률:  24%|██▍       | 1.21k/5.00k [00:01<00:03, 1.01kit/s]
학습 진행률:  26%|██▋       | 1.31k/5.00k [00:01<00:03, 1.01kit/s]
학습 진행률:  28%|██▊       | 1.42k/5.00k [00:01<00:03, 1.01kit/s]
학습 진행률:  30%|███       | 1.52k/5.00k [00:01<00:03, 1.01kit/s]
학습 진행률:  32%|███▏      | 1.62k/5.00k [00:01<00:03, 1.01kit/s]
학습 진행률:  34%|███▍      | 1.72k/5.00k [00:01<00:03, 994it/s]  
학습 진행률:  36%|███▋      | 1.82k/5.00k [00:01<00:03, 977it/s]
학습 진행률:  38%|███▊      | 1.92k/5.00k [00:01<00:03, 986it/s]
학습 진행률:  40%|████      | 2.02k/5.00k [00:02<00:03, 990it/s]
학습 진행률:  42%|████▏     | 2.12k/5.00k [00:02<00:02, 992it/s]
학습 진행률:  44%|████▍     | 2.22k/5.00k [00:02<00:02, 993it/s]
학습 진행률:  46%|████▋     | 2.32k/5.00k [00:02<00:02, 999it/s]
학습 진행률:  48%|████▊     | 2.42k/5.00k [00:02<00:02, 1.00kit/s]
학습 진행률:  51%|█████     | 2.53k/5.00k [00:02<00:02, 1.01kit/s]
학습 진행률:  53%|█████▎    | 2.63k/5.00k [00:02<00:02, 1.01kit/s]
학습 진행률:  55%|█████▍    | 2.73k/5.00k [00:02<00:02, 1.01kit/s]
학습 진행률:  57%|█████▋    | 2.83k/5.00k [00:02<00:02, 1.01kit/s]
학습 진행률:  59%|█████▊    | 2.94k/5.00k [00:02<00:02, 1.01kit/s]
학습 진행률:  61%|██████    | 3.04k/5.00k [00:03<00:01, 1.01kit/s]
학습 진행률:  63%|██████▎   | 3.14k/5.00k [00:03<00:01, 1.01kit/s]
학습 진행률:  65%|██████▍   | 3.24k/5.00k [00:03<00:01, 1.01kit/s]
학습 진행률:  67%|██████▋   | 3.34k/5.00k [00:03<00:01, 1.01kit/s]
학습 진행률:  69%|██████▉   | 3.44k/5.00k [00:03<00:01, 1.01kit/s]
학습 진행률:  71%|███████   | 3.54k/5.00k [00:03<00:01, 1.01kit/s]
학습 진행률:  73%|███████▎  | 3.64k/5.00k [00:03<00:01, 1.00kit/s]
학습 진행률:  75%|███████▍  | 3.74k/5.00k [00:03<00:01, 1.00kit/s]
학습 진행률:  77%|███████▋  | 3.84k/5.00k [00:03<00:01, 1.00kit/s]
학습 진행률:  79%|███████▉  | 3.94k/5.00k [00:03<00:01, 1.00kit/s]
학습 진행률:  81%|████████  | 4.05k/5.00k [00:04<00:00, 1.00kit/s]
학습 진행률:  83%|████████▎ | 4.15k/5.00k [00:04<00:00, 1.00kit/s]
학습 진행률:  85%|████████▍ | 4.25k/5.00k [00:04<00:00, 1.01kit/s]
학습 진행률:  87%|████████▋ | 4.35k/5.00k [00:04<00:00, 1.01kit/s]
학습 진행률:  89%|████████▉ | 4.45k/5.00k [00:04<00:00, 1.01kit/s]
학습 진행률:  91%|█████████ | 4.55k/5.00k [00:04<00:00, 1.01kit/s]
학습 진행률:  93%|█████████▎| 4.66k/5.00k [00:04<00:00, 1.01kit/s]
학습 진행률:  95%|█████████▌| 4.76k/5.00k [00:04<00:00, 1.01kit/s]
학습 진행률:  97%|█████████▋| 4.86k/5.00k [00:04<00:00, 1.01kit/s]
학습 진행률:  99%|█████████▉| 4.96k/5.00k [00:04<00:00, 1.01kit/s]
                                                             
학습 완료
```
