# 주가 예측 체험
이번 실습에서는 앞선 실습에서 확인한 주식 데이터를 바탕으로 딥러닝 모델을 학습시키고 이를 활용하여 주가 예측을 수행해 보겠습니다.

출력된 그래프는 2020년 7월 1일부터 30일까지의 종가를 비교하는 그래프로 파란선은 실제값을 의미하며, 노란선은 예측값을 의미합니다.

### 지시 사항
1. 아래 코드를 사용하여 딥러닝 모델의 학습과 예측을 수행해 보세요.
    - `ma.train()`
2. `실행` 버튼을 눌러 결과를 확인해 보세요.
3. `제출` 버튼을 눌러 학습과 예측을 올바르게 수행했는지 확인해 보세요.

## 답안
```
import machine as ma

def main():
    
    """
    지시사항 1번. 딥러닝 모델의 학습과 예측을 수행해 보세요.
    """
    ma.train()

if __name__ == "__main__":
    main()
```

### 실행 결과
```
2021-12-13 05:43:35.566980: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2021-12-13 05:43:35.578319: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2999995000 Hz
2021-12-13 05:43:35.578962: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x4c8fff0 executing computations on platform Host. Devices:
2021-12-13 05:43:35.579148: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm (LSTM)                  (None, 512)               1060864   
_________________________________________________________________
dense (Dense)                (None, 1)                 513       
_________________________________________________________________
re_lu (ReLU)                 (None, 1)                 0         
=================================================================
Total params: 1,061,377
Trainable params: 1,061,377
Non-trainable params: 0
_________________________________________________________________
Train on 73 samples
Epoch 1/1000
2021-12-13 05:43:39.561114: W tensorflow/core/grappler/optimizers/implementation_selector.cc:199] Skipping optimization due to error while loading function libraries: Invalid argument: Functions '__inference___backward_standard_lstm_726_1228_specialized_for_RMSprop_gradients_lstm_StatefulPartitionedCall_grad_StatefulPartitionedCall_at___inference_keras_scratch_graph_1744' and '__inference___backward_standard_lstm_726_1228' both implement 'lstm_3968b60b-cb25-4884-be3c-22ccf5fd7667' but their signatures do not match.
2021-12-13 05:43:39.689482: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1483] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.

73/73 [==============================] - 1s 11ms/sample - loss: 0.2510 - mae: 0.4635 - mape: 98.3489
Epoch 2/1000

73/73 [==============================] - 0s 527us/sample - loss: 0.1680 - mae: 0.3734 - mape: 611282.3125
Epoch 3/1000

73/73 [==============================] - 0s 350us/sample - loss: 0.1201 - mae: 0.3105 - mape: 1063922.5000
Epoch 4/1000

73/73 [==============================] - 0s 429us/sample - loss: 0.0878 - mae: 0.2597 - mape: 1423304.8750
Epoch 5/1000

73/73 [==============================] - 0s 551us/sample - loss: 0.0645 - mae: 0.2164 - mape: 1727746.7500
Epoch 6/1000

73/73 [==============================] - 0s 369us/sample - loss: 0.0475 - mae: 0.1797 - mape: 1990625.1250
Epoch 7/1000

73/73 [==============================] - 0s 304us/sample - loss: 0.0351 - mae: 0.1479 - mape: 2217409.5000
Epoch 8/1000

73/73 [==============================] - 0s 503us/sample - loss: 0.0264 - mae: 0.1208 - mape: 2410371.0000
Epoch 9/1000

73/73 [==============================] - 0s 280us/sample - loss: 0.0205 - mae: 0.0997 - mape: 2570513.5000
Epoch 10/1000

73/73 [==============================] - 0s 292us/sample - loss: 0.0165 - mae: 0.0861 - mape: 2698607.0000
Epoch 11/1000

73/73 [==============================] - 0s 391us/sample - loss: 0.0140 - mae: 0.0779 - mape: 2795814.5000
Epoch 12/1000

73/73 [==============================] - 0s 511us/sample - loss: 0.0124 - mae: 0.0732 - mape: 2864054.2500
Epoch 13/1000

73/73 [==============================] - 0s 364us/sample - loss: 0.0114 - mae: 0.0716 - mape: 2906091.7500
Epoch 14/1000

73/73 [==============================] - 0s 242us/sample - loss: 0.0107 - mae: 0.0714 - mape: 2925391.7500
Epoch 15/1000

73/73 [==============================] - 0s 611us/sample - loss: 0.0102 - mae: 0.0712 - mape: 2925800.0000
Epoch 16/1000

73/73 [==============================] - 0s 289us/sample - loss: 0.0098 - mae: 0.0707 - mape: 2911150.2500
Epoch 17/1000

73/73 [==============================] - 0s 286us/sample - loss: 0.0095 - mae: 0.0700 - mape: 2884931.5000
Epoch 18/1000

73/73 [==============================] - 0s 372us/sample - loss: 0.0091 - mae: 0.0691 - mape: 2850077.2500
Epoch 19/1000

73/73 [==============================] - 0s 343us/sample - loss: 0.0088 - mae: 0.0681 - mape: 2808886.5000
Epoch 20/1000

73/73 [==============================] - 0s 423us/sample - loss: 0.0085 - mae: 0.0669 - mape: 2763056.5000
Epoch 21/1000

73/73 [==============================] - 0s 329us/sample - loss: 0.0082 - mae: 0.0657 - mape: 2713776.2500
Epoch 22/1000

73/73 [==============================] - 0s 390us/sample - loss: 0.0078 - mae: 0.0644 - mape: 2661841.0000
Epoch 23/1000

73/73 [==============================] - 0s 456us/sample - loss: 0.0075 - mae: 0.0630 - mape: 2607755.5000
Epoch 24/1000

73/73 [==============================] - 0s 382us/sample - loss: 0.0072 - mae: 0.0616 - mape: 2551841.2500
Epoch 25/1000

73/73 [==============================] - 0s 416us/sample - loss: 0.0068 - mae: 0.0602 - mape: 2494292.5000
Epoch 26/1000

73/73 [==============================] - 0s 317us/sample - loss: 0.0065 - mae: 0.0587 - mape: 2435239.7500
Epoch 27/1000

73/73 [==============================] - 0s 399us/sample - loss: 0.0062 - mae: 0.0572 - mape: 2374783.7500
Epoch 28/1000

73/73 [==============================] - 0s 516us/sample - loss: 0.0059 - mae: 0.0556 - mape: 2313008.7500
Epoch 29/1000

73/73 [==============================] - 0s 450us/sample - loss: 0.0056 - mae: 0.0541 - mape: 2250008.7500
Epoch 30/1000

73/73 [==============================] - 0s 275us/sample - loss: 0.0053 - mae: 0.0526 - mape: 2185880.0000
Epoch 31/1000

73/73 [==============================] - 0s 262us/sample - loss: 0.0050 - mae: 0.0511 - mape: 2120742.7500
Epoch 32/1000

73/73 [==============================] - 0s 556us/sample - loss: 0.0047 - mae: 0.0497 - mape: 2054724.6250
Epoch 33/1000

73/73 [==============================] - 0s 376us/sample - loss: 0.0044 - mae: 0.0483 - mape: 1987974.1250
Epoch 34/1000

73/73 [==============================] - 0s 441us/sample - loss: 0.0042 - mae: 0.0469 - mape: 1920659.2500
Epoch 35/1000

73/73 [==============================] - 0s 532us/sample - loss: 0.0039 - mae: 0.0455 - mape: 1852964.6250
Epoch 36/1000

73/73 [==============================] - 0s 497us/sample - loss: 0.0037 - mae: 0.0442 - mape: 1785093.7500
Epoch 37/1000

73/73 [==============================] - 0s 573us/sample - loss: 0.0034 - mae: 0.0429 - mape: 1717267.5000
Epoch 38/1000

73/73 [==============================] - 0s 461us/sample - loss: 0.0032 - mae: 0.0415 - mape: 1649724.5000
Epoch 39/1000

73/73 [==============================] - 0s 356us/sample - loss: 0.0030 - mae: 0.0402 - mape: 1582719.3750
Epoch 40/1000

73/73 [==============================] - 0s 517us/sample - loss: 0.0029 - mae: 0.0391 - mape: 1516521.1250
Epoch 41/1000

73/73 [==============================] - 0s 480us/sample - loss: 0.0027 - mae: 0.0379 - mape: 1451408.5000
Epoch 42/1000

73/73 [==============================] - 0s 450us/sample - loss: 0.0026 - mae: 0.0369 - mape: 1387671.5000
Epoch 43/1000

73/73 [==============================] - 0s 480us/sample - loss: 0.0024 - mae: 0.0360 - mape: 1325603.0000
Epoch 44/1000

73/73 [==============================] - 0s 562us/sample - loss: 0.0023 - mae: 0.0353 - mape: 1265499.5000
Epoch 45/1000

73/73 [==============================] - 0s 512us/sample - loss: 0.0022 - mae: 0.0347 - mape: 1207648.1250
Epoch 46/1000

73/73 [==============================] - 0s 480us/sample - loss: 0.0021 - mae: 0.0341 - mape: 1152331.7500
Epoch 47/1000

73/73 [==============================] - 0s 463us/sample - loss: 0.0021 - mae: 0.0336 - mape: 1099809.1250
Epoch 48/1000

73/73 [==============================] - 0s 551us/sample - loss: 0.0020 - mae: 0.0332 - mape: 1050322.6250
Epoch 49/1000

73/73 [==============================] - 0s 531us/sample - loss: 0.0019 - mae: 0.0328 - mape: 1004079.6875
Epoch 50/1000

73/73 [==============================] - 0s 486us/sample - loss: 0.0019 - mae: 0.0324 - mape: 961252.1875
Epoch 51/1000

73/73 [==============================] - 0s 394us/sample - loss: 0.0019 - mae: 0.0321 - mape: 921968.3125
Epoch 52/1000

73/73 [==============================] - 0s 355us/sample - loss: 0.0018 - mae: 0.0319 - mape: 886307.3750
Epoch 53/1000

73/73 [==============================] - 0s 442us/sample - loss: 0.0018 - mae: 0.0317 - mape: 854297.0625
Epoch 54/1000

73/73 [==============================] - 0s 316us/sample - loss: 0.0018 - mae: 0.0316 - mape: 825906.3750
Epoch 55/1000

73/73 [==============================] - 0s 474us/sample - loss: 0.0018 - mae: 0.0314 - mape: 801058.8750
Epoch 56/1000

73/73 [==============================] - 0s 504us/sample - loss: 0.0018 - mae: 0.0313 - mape: 779606.7500
Epoch 57/1000

73/73 [==============================] - 0s 408us/sample - loss: 0.0018 - mae: 0.0313 - mape: 761393.6250
Epoch 58/1000

73/73 [==============================] - 0s 256us/sample - loss: 0.0018 - mae: 0.0312 - mape: 746126.1250
Epoch 59/1000

73/73 [==============================] - 0s 427us/sample - loss: 0.0018 - mae: 0.0311 - mape: 733737.3125
Epoch 60/1000

73/73 [==============================] - 0s 531us/sample - loss: 0.0017 - mae: 0.0311 - mape: 723381.0625
Epoch 61/1000

73/73 [==============================] - 0s 263us/sample - loss: 0.0017 - mae: 0.0310 - mape: 716577.5625
Epoch 62/1000

73/73 [==============================] - 0s 379us/sample - loss: 0.0017 - mae: 0.0310 - mape: 706790.8750
Epoch 63/1000
```
```
Epoch 970/1000

73/73 [==============================] - 0s 150us/sample - loss: 0.0013 - mae: 0.0267 - mape: 708111.3125
Epoch 971/1000

73/73 [==============================] - 0s 139us/sample - loss: 0.0013 - mae: 0.0307 - mape: 461355.4062
Epoch 972/1000

73/73 [==============================] - 0s 157us/sample - loss: 0.0013 - mae: 0.0267 - mape: 702077.6875
Epoch 973/1000

73/73 [==============================] - 0s 160us/sample - loss: 0.0013 - mae: 0.0307 - mape: 467517.9062
Epoch 974/1000

73/73 [==============================] - 0s 158us/sample - loss: 0.0013 - mae: 0.0267 - mape: 707458.7500
Epoch 975/1000

73/73 [==============================] - 0s 136us/sample - loss: 0.0013 - mae: 0.0307 - mape: 460761.5312
Epoch 976/1000

73/73 [==============================] - 0s 148us/sample - loss: 0.0013 - mae: 0.0267 - mape: 702476.5625
Epoch 977/1000

73/73 [==============================] - 0s 181us/sample - loss: 0.0013 - mae: 0.0307 - mape: 467776.4375
Epoch 978/1000

73/73 [==============================] - 0s 169us/sample - loss: 0.0013 - mae: 0.0267 - mape: 706693.6875
Epoch 979/1000

73/73 [==============================] - 0s 165us/sample - loss: 0.0013 - mae: 0.0307 - mape: 460302.6250
Epoch 980/1000

73/73 [==============================] - 0s 170us/sample - loss: 0.0013 - mae: 0.0267 - mape: 702937.4375
Epoch 981/1000

73/73 [==============================] - 0s 148us/sample - loss: 0.0013 - mae: 0.0307 - mape: 467916.8125
Epoch 982/1000

73/73 [==============================] - 0s 167us/sample - loss: 0.0013 - mae: 0.0267 - mape: 705935.2500
Epoch 983/1000

73/73 [==============================] - 0s 147us/sample - loss: 0.0013 - mae: 0.0306 - mape: 459902.7812
Epoch 984/1000

73/73 [==============================] - 0s 154us/sample - loss: 0.0013 - mae: 0.0267 - mape: 703435.4375
Epoch 985/1000

73/73 [==============================] - 0s 158us/sample - loss: 0.0013 - mae: 0.0306 - mape: 467955.8750
Epoch 986/1000

73/73 [==============================] - 0s 157us/sample - loss: 0.0013 - mae: 0.0267 - mape: 705178.6250
Epoch 987/1000

73/73 [==============================] - 0s 164us/sample - loss: 0.0013 - mae: 0.0306 - mape: 459623.6562
Epoch 988/1000

73/73 [==============================] - 0s 160us/sample - loss: 0.0013 - mae: 0.0267 - mape: 703925.2500
Epoch 989/1000

73/73 [==============================] - 0s 138us/sample - loss: 0.0013 - mae: 0.0306 - mape: 467893.3750
Epoch 990/1000

73/73 [==============================] - 0s 174us/sample - loss: 0.0013 - mae: 0.0267 - mape: 704399.3125
Epoch 991/1000

73/73 [==============================] - 0s 150us/sample - loss: 0.0013 - mae: 0.0306 - mape: 459524.6250
Epoch 992/1000

73/73 [==============================] - 0s 153us/sample - loss: 0.0013 - mae: 0.0267 - mape: 704380.3750
Epoch 993/1000

73/73 [==============================] - 0s 190us/sample - loss: 0.0013 - mae: 0.0306 - mape: 467725.4688
Epoch 994/1000

73/73 [==============================] - 0s 160us/sample - loss: 0.0013 - mae: 0.0266 - mape: 703645.3125
Epoch 995/1000

73/73 [==============================] - 0s 162us/sample - loss: 0.0013 - mae: 0.0306 - mape: 459507.0000
Epoch 996/1000

73/73 [==============================] - 0s 146us/sample - loss: 0.0013 - mae: 0.0267 - mape: 704830.9375
Epoch 997/1000

73/73 [==============================] - 0s 160us/sample - loss: 0.0013 - mae: 0.0306 - mape: 467461.9688
Epoch 998/1000

73/73 [==============================] - 0s 175us/sample - loss: 0.0013 - mae: 0.0266 - mape: 702937.3750
Epoch 999/1000

73/73 [==============================] - 0s 146us/sample - loss: 0.0013 - mae: 0.0306 - mape: 459531.5938
Epoch 1000/1000

73/73 [==============================] - 0s 192us/sample - loss: 0.0013 - mae: 0.0266 - mape: 705266.6875
```
![image](https://user-images.githubusercontent.com/61646760/145758943-c51adac5-985d-409c-aabd-e690f7311164.png)
